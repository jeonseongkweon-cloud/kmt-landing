<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ê³µì§€ì‚¬í•­ | ê³„ëª…íƒœê¶Œë„</title>
  <meta name="description" content="ê³„ëª…íƒœê¶Œë„ ê³µì§€ì‚¬í•­. ê³µê°œ ì•ˆë‚´/í–‰ì‚¬/ìš´ì˜ ê³µì§€ë¥¼ í•œ ê³³ì—ì„œ í™•ì¸í•©ë‹ˆë‹¤." />
  <meta name="theme-color" content="#0b0f19" />

  <style>
    :root{
      --bg:#0b0f19;
      --card:#10172a;
      --line:rgba(255,255,255,.10);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.72);
      --radius:18px;
      --shadow: 0 18px 55px rgba(0,0,0,.35);
      --max: 980px;
      --accent: rgba(255,138,0,.22);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 10% 10%, rgba(74,163,255,.16), transparent 60%),
        radial-gradient(900px 500px at 90% 0%, rgba(216,183,102,.14), transparent 60%),
        var(--bg);
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--max); margin:0 auto; padding:18px 16px 36px}

    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; padding:8px 0 14px; flex-wrap:wrap;
    }
    .home{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius:999px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      transition:.2s ease;
      font-weight:900;
      white-space:nowrap;
    }
    .home:hover{transform:translateY(-1px); border-color:rgba(255,255,255,.18)}

    .search{
      flex:1; min-width:220px;
      display:flex; gap:8px; align-items:center;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
    }
    .search input{
      width:100%; border:0; outline:0;
      background:transparent; color:var(--text);
      font-size:14px;
    }

    h1{margin:4px 0 6px; font-size:22px; letter-spacing:-.2px;}
    .lead{margin:0 0 12px; color:var(--muted); font-size:13px; line-height:1.6;}

    .filters{display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 12px;}
    .chip{
      padding:8px 10px; border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12px; font-weight:800;
      cursor:pointer;
      user-select:none;
    }
    .chip.on{
      border-color: var(--accent);
      color:var(--text);
      background: rgba(255,138,0,.10);
    }

    .grid{display:grid; grid-template-columns:1fr; gap:10px;}
    @media (min-width:760px){ .grid{grid-template-columns:1fr 1fr;} }

    .card{
      border:1px solid var(--line);
      background: rgba(16,23,42,.72);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding:14px 14px 10px;
      display:flex; justify-content:space-between; gap:10px; align-items:flex-start;
    }
    .tag{
      font-size:11px; font-weight:950;
      padding:6px 10px; border-radius:999px;
      background: rgba(255,138,0,.12);
      border:1px solid var(--accent);
      color: rgba(255,255,255,.92);
      white-space:nowrap;
      flex:0 0 auto;
    }
    .date{color:var(--muted); font-size:12px; margin-top:2px;}
    .title{font-size:14px; font-weight:950; line-height:1.35; margin-top:6px;}
    .meta{color:var(--muted); font-size:12px; line-height:1.55; margin-top:8px;}

    .cardBody{
      padding:0 14px 14px;
      color: rgba(255,255,255,.86);
      font-size:12.5px;
      line-height:1.78;
      display:none;
      word-break: keep-all;
    }

    .actions{
      display:flex; gap:8px; flex-wrap:wrap;
      padding:12px 14px 14px;
      border-top:1px solid rgba(255,255,255,.06);
      background: rgba(255,255,255,.02);
    }
    .btn{
      padding:9px 11px;
      border-radius: 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      font-weight:900;
      font-size:12px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }

    .empty{
      margin-top:10px;
      padding:14px;
      border:1px dashed rgba(255,255,255,.18);
      border-radius:16px;
      color:var(--muted);
      text-align:center;
    }

    footer{margin-top:18px; text-align:center; color:rgba(255,255,255,.55); font-size:12px;}

    /* âœ… â€œë”± í•œ ê¸€ ëª¨ë“œâ€ì¼ ë•Œ UI ì •ë¦¬ */
    .singleMode .lead,
    .singleMode .filters,
    .singleMode .search{ display:none; }
    .singleMode .grid{ grid-template-columns: 1fr; }
  </style>
</head>

<body>
  <div class="wrap" id="wrap">
    <div class="topbar">
      <a class="home" href="../">â† í™ˆí˜ì´ì§€ ë°”ë¡œê°€ê¸°</a>
      <div class="search" title="ê²€ìƒ‰">
        ğŸ” <input id="q" type="search" placeholder="ê³µì§€ ê²€ìƒ‰ (ì˜ˆ: ì…í•™, ì°¨ëŸ‰, ì‹¬ì‚¬, í–‰ì‚¬â€¦)" />
      </div>
    </div>

    <h1>ê³µì§€ì‚¬í•­</h1>
    <p class="lead">ê³µê°œ ê°€ëŠ¥í•œ ì•ˆë‚´/í–‰ì‚¬/ìš´ì˜ ê³µì§€ë¥¼ ëª¨ì•„ë‘¡ë‹ˆë‹¤. (íšŒì› ì „ìš© ë‚´ìš©ì€ ë°´ë“œì—ì„œ ìš´ì˜)</p>

    <div class="filters" id="filters"></div>
    <div class="grid" id="list"></div>

    <div class="empty" id="empty" style="display:none;"></div>

    <footer>Â© <span id="y"></span> ê³„ëª…íƒœê¶Œë„</footer>
  </div>

  <!-- âœ… ê³µì§€ ë°ì´í„° -->
  <script src="./data.js"></script>

  <script>
    const $ = (s)=>document.querySelector(s);
    const wrapEl = $("#wrap");
    const listEl = $("#list");
    const emptyEl = $("#empty");
    const qEl = $("#q");
    const filtersEl = $("#filters");

    const all = Array.isArray(window.notices) ? window.notices : [];
    const sorted = [...all].sort((a,b)=> String(b.date||"").localeCompare(String(a.date||"")));

    const tags = Array.from(new Set(sorted.map(n=> (n.tag||"ê³µì§€").trim()))).filter(Boolean);
    let activeTag = "ì „ì²´";

    function safe(v){ return (v==null) ? "" : String(v); }

    function chip(label){
      const d = document.createElement("div");
      d.className = "chip" + (label===activeTag ? " on" : "");
      d.textContent = label;
      d.onclick = ()=>{ activeTag = label; render(); updateChips(); };
      return d;
    }
    function updateChips(){
      [...filtersEl.children].forEach(ch=>{
        ch.classList.toggle("on", ch.textContent===activeTag);
      });
    }

    // chips
    filtersEl.innerHTML = "";
    filtersEl.appendChild(chip("ì „ì²´"));
    tags.forEach(t=>filtersEl.appendChild(chip(t)));

    function render(filterDate){
      const q = (qEl && qEl.value ? qEl.value : "").trim().toLowerCase();

      let filtered = sorted;

      if(filterDate){
        filtered = filtered.filter(n => safe(n.date).trim() === filterDate);
      }else{
        filtered = filtered.filter(n=>{
          const tagOk = (activeTag==="ì „ì²´") ? true : (safe(n.tag||"ê³µì§€").trim()===activeTag);
          const text = `${safe(n.date)} ${safe(n.tag)} ${safe(n.title)} ${safe(n.meta)} ${safe(n.content)}`.toLowerCase();
          const qOk = q ? text.includes(q) : true;
          return tagOk && qOk;
        });
      }

      listEl.innerHTML = "";

      if(!sorted.length){
        emptyEl.style.display = "block";
        emptyEl.textContent = "ê³µì§€ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. (notice/data.jsê°€ ë¡œë”©ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆì–´ìš”)";
        return;
      }

      if(!filtered.length){
        emptyEl.style.display = "block";
        emptyEl.textContent = "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.";
        return;
      }

      emptyEl.style.display = "none";

      filtered.forEach((n, idx)=>{
        const card = document.createElement("div");
        card.className = "card";

        const tag = safe(n.tag || "ê³µì§€");
        const date = safe(n.date || "");
        const title = safe(n.title || "");
        const meta = safe(n.meta || "");
        const content = safe(n.content || "");
        const url = (n.url && String(n.url).trim()) ? String(n.url).trim() : "";

        card.innerHTML = `
          <div class="cardHead">
            <div style="min-width:0; flex:1;">
              <div class="date">${date}</div>
              <div class="title">${title}</div>
              ${meta ? `<div class="meta">${meta}</div>` : ``}
            </div>
            <div class="tag">${tag}</div>
          </div>

          <div class="cardBody" id="body-${idx}">
            ${content}
          </div>

          <div class="actions">
            <button class="btn" data-toggle="${idx}">ë‚´ìš© ë³´ê¸°</button>
            ${url ? `<a class="btn" href="${url}" target="_blank" rel="noopener">ê´€ë ¨ ë§í¬</a>` : ``}
            <button class="btn" data-copy="${date}">ë§í¬ ë³µì‚¬</button>
          </div>
        `;

        listEl.appendChild(card);
      });

      // toggle
      listEl.querySelectorAll("[data-toggle]").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const i = btn.getAttribute("data-toggle");
          const body = document.getElementById(`body-${i}`);
          const on = body.style.display === "block";
          body.style.display = on ? "none" : "block";
          btn.textContent = on ? "ë‚´ìš© ë³´ê¸°" : "ì ‘ê¸°";
        });
      });

      // copy link by date
      listEl.querySelectorAll("[data-copy]").forEach(btn=>{
        btn.addEventListener("click", async ()=>{
          const date = btn.getAttribute("data-copy");
          const link = `${location.origin}${location.pathname}#${encodeURIComponent(date)}`;
          try{
            await navigator.clipboard.writeText(link);
            btn.textContent = "ë³µì‚¬ ì™„ë£Œ!";
            setTimeout(()=>btn.textContent="ë§í¬ ë³µì‚¬", 1200);
          }catch(e){
            prompt("ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•˜ì„¸ìš”:", link);
          }
        });
      });
    }

    if(qEl) qEl.addEventListener("input", ()=>render());

    document.getElementById("y").textContent = new Date().getFullYear();

    // âœ… â€œë”± í•œ ê¸€â€ ë§í¬ ëª¨ë“œ: /notice/#YYYY-MM-DD
    (function singleNoticeByHash(){
      const hash = decodeURIComponent(location.hash || "").replace("#","").trim();

      if(hash){
        // single mode: UI ìˆ¨ê¸°ê³  í•´ë‹¹ ë‚ ì§œë§Œ ë Œë”
        wrapEl.classList.add("singleMode");
        render(hash);

        // ë Œë”ëœ ì²« ì¹´ë“œ ìë™ í¼ì¹˜ê¸° + ìŠ¤í¬ë¡¤
        setTimeout(()=>{
          const firstToggle = listEl.querySelector("[data-toggle]");
          const firstCard = listEl.querySelector(".card");
          if(firstToggle) firstToggle.click();
          if(firstCard) firstCard.scrollIntoView({behavior:"smooth", block:"start"});
        }, 30);

        return;
      }

      // ì¼ë°˜ ëª©ë¡ ëª¨ë“œ
      render();
      updateChips();
    })();
  </script>
</body>
</html>
